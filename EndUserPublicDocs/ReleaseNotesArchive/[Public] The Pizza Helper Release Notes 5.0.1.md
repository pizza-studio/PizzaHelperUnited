// 《（统一）披萨小助手》v5.0.1 的更新内容简述

- 现支持为不同游戏分别设定自定义体力通知阈值。
- 修复了 iOS 系统下无法清除 App 图标通知红点的问题。
- 在用户允许的情况下，将始终提醒凯瑟琳每日奖励可领取状态，不再受每日任务完成情况影响。
- 大幅优化小工具的排版和文字可见性，并修复了小工具背景的 Gamma 和饱和度失控问题。
- 大尺寸小工具现支持显示《崩坏：星穹铁道》派遣委托的副手角色肖像。
- 小工具的默认同步时间间隔缩短为六分钟。
- 优化中文界面部分用词。
- 撤换英文界面中可能对非英语母语用户不友好的美军用语。
- 修复通知设定界面与小工具设定界面中的部分本地化错误。
- 修复法文与韩文界面某些字符串参数无法正常显示的问题。
- 解决了无法上传「战斗场数不超过两层」的深境螺旋战报的问题。在用户事先有授权过的情况下，App 如今会尝试向披萨深渊排行榜补交 2024-10-15 至 2024-11-16 赛季的深渊战报（截止日期是该年 12 月 15 日）。
- 修复递交《原神》深渊战报时无法正常获取 retCode 的问题。
- 在导入《原神》披萨小助手抽卡记录时，新增使用 Trie 算法自动处理物品名称中最多一个错别字的功能。以 GIGF 格式（UIGF v2 ~ v3）记录导入时也支持上述功能。如超出错别字处理范围，仍会抛出错误，并追加显示对应记录的 UID。
- 在本地账号 SwiftData SQLite 数据库故障自动重置时，App 会尝试从 UserDefaults 恢复本地账号数据备份。

// CHT ---------------------------------------------

// 《（統一）披薩小助手》v5.0.1 的更新內容簡述

- 現支援為不同遊戲分別設定自訂玩家體力通知閾值。
- 修復了 iOS 系統下無法清除 App 圖標通知紅點的問題。
- 在使用者允許的情況下，將始終提醒凱瑟琳每日獎勵可領取狀態，不再受每日任務完成情況影響。
- 大幅優化小工具的排版和文字可見性，並修復了小工具背景的 Gamma 和飽和度失控問題。
- 大尺寸小工具現支援顯示《崩壞：星穹鐵道》派遣委託的副手角色肖像。
- 小工具的默認同步時間間隔縮短為六分鐘。
- 調整中文界面部分用詞。
- 撤換英文界面中可能對非英語母語使用者不友好的美軍用語。
- 修復通知設定界面與小工具設定界面中的部分本地化錯誤。
- 修復法文與韓文界面某些字符串參數無法正常顯示的問題。
- 解決了無法上傳「戰鬥場數不超過兩層」的深境螺旋戰報的問題。在使用者事先有授權過的情況下，App 如今會嘗試向披薩深淵排行榜補交 2024-10-15 至 2024-11-16 賽季的深淵戰報（截止日期是該年 12 月 15 日）。
- 修復遞交《原神》深淵戰報時無法正常獲取 retCode 的問題。
- 在匯入《原神》披薩小助手抽卡記錄時，新增使用 Trie 算法自動處理物品名稱中最多一個錯別字的功能。以 GIGF 格式（UIGF v2 ~ v3）記錄匯入時也支援上述功能。如超出錯別字處理範圍，仍會拋出錯誤，並追加顯示對應記錄的 UID。
- 在本地帳號 SwiftData SQLite 資料庫故障自動重置時，App 會嘗試從 UserDefaults 恢復本地帳號資料備份。

// JPN ---------------------------------------------

// 「ピザ助手（無印）」v5.0.1 版が更新した内容：

- 各ゲームごとにスタミナ通知閾値を個別に設定できるようになりました。
- iOS システムでアプリのアイコン通知バッジが消せない問題を修正しました。
- キャサリンのデイリー報酬受け取り可能通知を送るかどうかを判断する際、デイリーミッションの完了状況は考慮しなくなりました。
- ウィジェットのレイアウトとテキストの視認性を大幅に改善し、ウィジェット背景のガンマ値や彩度の暴走問題も修正しました。
- 大型ウィジェットに《崩壊：スターレイル》の派遣任務で副キャラクターの肖像を表示する機能を追加しました。
- ウィジェットのデフォルト同期間隔を6分に短縮しました。
- 中国語インターフェースの表現を一部改善しました。
- 英語インターフェースで非英語ネイティブユーザーに優しくない米軍用語を置き換えました。
- 通知設定画面とウィジェット設定画面における一部のローカライズエラーを修正しました。
- フランス語および韓国語インターフェースで一部の文字列パラメータが正常に表示されない問題を解決しました。
- 「戦闘階層が2つだけ」の深境螺旋作戦報告をピザ深淵ランキングサーバー（と胡桃深淵ランキングサーバー）へ上載せられない問題を解決しました。ユーザーが事前に許可済みの場合、アプリは2024年10月15日から11月16日までのシーズンの深境螺旋作戦報告をピザ深淵ランキングサーバーに上載せようとしてみます（締切：2024年12月15日）。
- 《原神》深境螺旋作戦報告の提出時に retCode が正常に取得できない問題を修正しました。
- 《原神》ピザ小助手のガチャ記録インポート時、Trie アルゴリズムを使用してアイテム名の誤字を最大1つまで自動修正する機能を追加しました。この機能は GIGF 形式（UIGF v2～v3）の記録にも対応しています。修正範囲を超える誤字がある場合、エラーを捨て出し、該当記録の所属 UID も追加表示します。
- これからは、ローカルプロファイルの SwiftData SQLite データベースが崩れた場合、アプリは UserDefaults からローカルプロファイルデータのバックアップを復元しようとします。

// ENU ---------------------------------------------

// Major changes introduced in The Pizza Helper v5.0.1:

- The app now supports setting custom stamina notification thresholds for different games individually.
- Fixed an issue where the app icon notification badge could not be cleared on iOS.
- The app will not consider the daily task completion status when deciding whether to send notifications regarding the availability of Katherine's daily rewards.
- Significantly improved widget layout and text visibility, and resolved issues with uncontrolled Gamma and saturation levels in widget backgrounds.
- Large-size widgets now support displaying copilot characters' portraits for Star Rail expeditions (assignments).
- The default widget synchronization interval has been reduced to 6 minutes.
- Optimized wording in the Chinese interface.
- Replaced U.S. military jargons in the English interface that might not be user-friendly for non-native English speakers.
- Fixed localization errors in the notification settings and widget settings interfaces.
- Resolved issues with certain string parameters not displaying correctly in the French and Korean interfaces.
- Fixed an issue that the app refuses to upload Spiral Abyss Battle Report to PizzaAbyssDB and HutaoDB if user has skipped the battles at floor 9 and 10. If previously permitted by the user, the app will attempt to reupload Genshin Impact Spiral Abyss Battle Report of the season between 2024-10-15 and 2024-11-16.
- Fixed an issue where the server response retCode could not be properly decoded when submitting Genshin Impact Abyss reports.
- The Gacha Record Manager now has the ability to use Trie to handle possible typos among the item names of the gacha records imported from GIGF (UIGF v2 ~v3) or inherited from the previous "Pizza Helper for Genshin", unless the typo consists of more than 1 character per each item. Also, if not handleable, the error thrown will indicate the UID of the gacha item whenever possible. The devs will do further optimizations against the experience of data migration from previous old Pizza Apps whenever necessary.
- The app will now attempt to restore local profile backups from UserDefaults if the locale profile dedicated SwiftData file gets corrupted.

// RUS ---------------------------------------------

// Основные изменения в The Pizza Helper v5.0.1:

- Приложение теперь поддерживает установку индивидуальных порогов уведомлений о выносливости для разных игр.
- Исправлена проблема, из-за которой значок уведомления на иконке приложения не удалялся в iOS.
- Если настройки уведомлений в приложении позволяют, приложение всегда будет напоминать пользователям о доступности ежедневных наград от Кэтрин, независимо от статуса выполнения ежедневных заданий.
- Существенно улучшена компоновка виджетов и читаемость текста, а также решены проблемы с неконтролируемым уровнем гаммы и насыщенности фона виджетов.
- Крупные виджеты теперь поддерживают отображение портретов вспомогательных персонажей для экспедиций (заданий) в Star Rail.
- Интервал синхронизации виджетов по умолчанию сокращен до 6 минут.
- Оптимизирована формулировка текста в китайском интерфейсе.
- В английском интерфейсе заменена военная терминология США, которая могла быть неудобной для пользователей, не являющихся носителями языка.
- Исправлены ошибки локализации в интерфейсах настроек уведомлений и настроек виджетов.
- Решены проблемы с отображением некоторых строковых параметров во французском и корейском интерфейсах.
- Исправлена проблема, из-за которой приложение отказывалось загружать отчеты о сражениях в Бездне (Spiral Abyss) в базы данных PizzaAbyssDB и HutaoDB, если пользователь пропускал битвы на 9 и 10 этажах. При предварительном разрешении пользователя приложение попытается повторно загрузить отчет о сражениях в Бездне за сезон с 15 октября по 16 ноября 2024 года.
- Исправлена ошибка, из-за которой серверный ответ retCode не декодировался корректно при отправке отчетов о Бездне в Genshin Impact.
- Менеджер записей Гача теперь может использовать алгоритм Trie для обработки возможных опечаток в названиях предметов при импорте записей из формата GIGF (UIGF v2~v3) или из предыдущей версии "Pizza Helper для Genshin", если ошибка не превышает 1 символ в каждом названии предмета. Если обработка невозможна, приложение выдаст ошибку с указанием UID записи, если это возможно. Разработчики продолжат оптимизировать процесс миграции данных из старых версий Pizza Apps при необходимости.
- Теперь приложение будет пытаться восстановить локальные резервные копии профиля из UserDefaults, если файл SwiftData, предназначенный для локального профиля, будет поврежден.
